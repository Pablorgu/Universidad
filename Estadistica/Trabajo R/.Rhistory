read.csv("C:\Users\pablo\Documents\UNIV AUX\Universidad\Estadistica\R primer parcial/dfMec.csv")
2+2
d<-read.csv("C:\Users\pablo\Documents\UNIV AUX\Universidad\Estadistica\R primer parcial/dfMec.csv")
d <- read.csv("Users\pablo\Documents\UNIV AUX\Universidad\Estadistica\R primer parcial/dfMec.csv")
d <- read.csv("Users\pablo\Documents\UNIV AUX\Universidad\Estadistica\Rprimerparcial/dfMec.csv")
d <- read.csv("Users\pablo\Documents\UNIV AUX\Universidad\Estadistica\Rprimerparcial\dfMec.csv")
d <- read.csv("C:/Users/pablo\Documents/UNIV AUX/Universidad/Estadistica/Rprimerparcial/dfMec.csv")
d <- read.csv("C:/Users/pablo/Documents/UNIV AUX/Universidad/Estadistica/Rprimerparcial/dfMec.csv")
#EJERCICIO 1
#Configuro el directorio de trabajo
setwd("~/UNIV AUX/Universidad/Estadistica/Trabajo R")
#Primero empiezo importando el archivo pero usando la libreria readr y con barra baja en lugar
#de punto para que devuelva un tibble en vez de un data frame, asignare tipos a las columnas ya que cada una
#representa un tipo de datos distinto, por ejemplo las de ingresos, sexo o estudios que representan variables categóricas
library(readr)
library(tidyverse)
library(purrr)
datos <- read_csv("18608.csv", col_types=cols(.default=col_double(), sexo=col_factor(),
dietaEsp=col_factor(), nivEstPad=col_factor(),
nivEstudios=col_factor(), nivIngresos=col_factor()))
#EJERCICIO 2
#Ahora cargare la operacion para calcular el IMC en la variable, la formula del imc es peso en kg dividido entre la altura en metros al cuadrado,
#el peso y la altura en este caso seran variables dependientes mientras que el resto seran independientes
calc_imc<- function(peso, altura){
imc<- peso/altura^2
}
datos <- datos %>% mutate(IMC=calc_imc(datos$peso, datos$altura))
#EJERCICIO 3
#Ahora tratare de eliminar las filas en las que nos falte algun dato
datos <- na.omit(datos)
#EJERCICIO 4
#Primero para quedarme con las variables numéricas aprovechare la función is.numeric con la función keep
##lo guardo en la variable datos numericos y con un map le aplico la funcion mean a todo el dataframe
datosNumericos <- keep(datos, is.numeric)
datosMedia<- map_dbl(datosNumericos, mean)
desvTipica <- map_dbl(datosNumericos, sd)
desvTipicasBessel <- map_dbl(datosNumericos, function(x) sqrt(sum((x-mean(x))^2) / (length(x)-1)))
#EJERCICIO 5
#Lo primero que hare sera extraer las variables independientes
VariablesInd <- names(datos[3:14])
#Una vez los tengo usare lm y summary para obtener los coeficientes de regresion que cuantifican la relacion entre la variable dependiente e independiente
coeficienteReg<-function(df, y, x) {
modelo<- lm(y ~ x, df)
summary(modelo)$coefficients[2]
}
#El siguiente paso sera calcular el coeficiente de determinación que nos indica cuanto depende la variable dependiente de la variable independiente
coeficienteDet <- function(df, y, x) {
modelo<- lm(y ~ x, df)
summary(modelo)$r.squared
}
#Ahora calculare el coeficiente de regresión entre la variable de respuesta IMC
#y cada una de las variables predictoras
coeficientesRegIMC <- map_dbl(VariablesInd,~ coeficienteReg(datos, datos$IMC, datos[[.]]))
#Y hare lo mismo con el coeficiente de determinacion
coeficientesDetIMC <- map_dbl(VariablesInd,~ coeficienteDet(datos, datos$IMC, datos[[.]]))
View(coeficienteReg)
View(coeficienteDet)
#Ahora calculare el coeficiente de regresión entre la variable de respuesta IMC
#y cada una de las variables predictoras
coeficientesRegIMC <- map_dbl(VariablesInd,~ coeficienteReg(datos, datos$IMC, .x))
#EJERCICIO 1
#Configuro el directorio de trabajo
setwd("~/UNIV AUX/Universidad/Estadistica/Trabajo R")
#Primero empiezo importando el archivo pero usando la libreria readr y con barra baja en lugar
#de punto para que devuelva un tibble en vez de un data frame, asignare tipos a las columnas ya que cada una
#representa un tipo de datos distinto, por ejemplo las de ingresos, sexo o estudios que representan variables categóricas
library(readr)
library(tidyverse)
library(purrr)
datos <- read_csv("18608.csv", col_types=cols(.default=col_double(), sexo=col_factor(),
dietaEsp=col_factor(), nivEstPad=col_factor(),
nivEstudios=col_factor(), nivIngresos=col_factor()))
#EJERCICIO 2
#Ahora cargare la operacion para calcular el IMC en la variable, la formula del imc es peso en kg dividido entre la altura en metros al cuadrado,
#el peso y la altura en este caso seran variables dependientes mientras que el resto seran independientes
calc_imc<- function(peso, altura){
imc<- peso/altura^2
}
datos <- datos %>% mutate(IMC=calc_imc(datos$peso, datos$altura))
#EJERCICIO 3
#Ahora tratare de eliminar las filas en las que nos falte algun dato
datos <- na.omit(datos)
#EJERCICIO 4
#Primero para quedarme con las variables numéricas aprovechare la función is.numeric con la función keep
##lo guardo en la variable datos numericos y con un map le aplico la funcion mean a todo el dataframe
datosNumericos <- keep(datos, is.numeric)
datosMedia<- map_dbl(datosNumericos, mean)
desvTipica <- map_dbl(datosNumericos, sd)
desvTipicasBessel <- map_dbl(datosNumericos, function(x) sqrt(sum((x-mean(x))^2) / (length(x)-1)))
#EJERCICIO 5
#Lo primero que hare sera extraer las variables independientes
VariablesInd <- names(datos[3:14])
#Una vez los tengo usare lm y summary para obtener los coeficientes de regresion que cuantifican la relacion entre la variable dependiente e independiente
coeficienteReg<-function(df, y, x) {
modelo<- lm(y ~ x, df)
summary(modelo)$coefficients[2]
}
#El siguiente paso sera calcular el coeficiente de determinación que nos indica cuanto depende la variable dependiente de la variable independiente
coeficienteDet <- function(df, y, x) {
modelo<- lm(y ~ x, df)
summary(modelo)$r.squared
}
#Ahora calculare el coeficiente de regresión entre la variable de respuesta IMC
#y cada una de las variables predictoras
coeficientesRegIMC <- map_dbl(VariablesInd,~ coeficienteReg(datos, datos$IMC, .x))
#Y hare lo mismo con el coeficiente de determinacion
coeficientesDetIMC <- map_dbl(VariablesInd,~ coeficienteDet(datos, datos$IMC, .x))
#Ahora calculare el coeficiente de regresión entre la variable de respuesta IMC
#y cada una de las variables predictoras
coeficientesRegIMC <- map_dbl(VariablesInd,~ coeficienteReg(datos, datos$IMC, datos[[.x]]))
#Y hare lo mismo con el coeficiente de determinacion
coeficientesDetIMC <- map_dbl(VariablesInd,~ coeficienteDet(datos, datos$IMC, datos[[.x]]))
desvTipicasBessel
datosNumericos
View(datos)
